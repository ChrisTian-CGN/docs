__NUXT_JSONP__("/articles/active-directory-client", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){return {data:[{article:{slug:"active-directory-client",description:"Learn how to join Pop!_OS to an Active Directory domain",title:"Active Directory Domain",keywords:["Pop!_OS","Security","Linux","Active Directory","Authentication"],facebookImage:"\u002F_nuxt\u002Fimages\u002Factive-directory-client-facebookImage.jpg",twitterImage:"\u002F_nuxt\u002Fimages\u002Factive-directory-client-twitterImage.jpg",hidden:false,section:"software",toc:[],body:{type:"root",children:[{type:a,tag:g,props:{},children:[{type:b,value:"Pop!_OS and Ubuntu can be joined to an Active Directory domain, which allows users to log in with their existing network credentials."}]},{type:b,value:c},{type:a,tag:"ol",props:{},children:[{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Install the necessary packages:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo apt install sssd heimdal-clients msktutil"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"While installing those packages, you will be prompted for the following information. These are sample responses. Our domain is called \"system76.local\" and our Active Directory server is called \"adserver\" in this example:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"Forest name: SYSTEM76"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"Domain controller hostname: ADSERVER.system76.local"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"Administrative server "}]},{type:a,tag:d,props:{style:"color: var(--code-0A)"},children:[{type:b,value:"for"}]},{type:a,tag:d,props:{style:f},children:[{type:b,value:" your Kerberos realm: ADSERVER.system76.local"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c}]},{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Move the default Kerberos configuration file to a backup, and create a fresh file to use:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo mv \u002Fetc\u002Fkrb5.conf \u002Fetc\u002Fkrb5.conf.default"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo nano \u002Fetc\u002Fkrb5.conf"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Edit the \u002Fetc\u002Fkrb5.conf file with the following contents:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"[libdefaults]\ndefault_realm = SYSTEM76.LOCAL\nrdns = no\ndns_lookup_kdc = true\ndns_lookup_realm = true\n\n[realms]\nSYSTEM76.LOCAL = {\nkdc = ADSERVER.system76.local\nadmin_server = ADSERVER.system76.local\n}\n"}]}]}]}]}]},{type:b,value:c}]},{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Initialize Kerberos and generate a keytab file. The first command requires the username of a domain administrator, and our computer's hostname is \"pop-os\" in this example:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"kinit administrator\nklist\nmsktutil -N -c -b 'CN=COMPUTERS' -s POP-OS\u002Fpop-os.system76.local -k my-keytab.keytab ‑‑computer-name POP-OS ‑‑upn POP-OS$ ‑‑server adserver.system76.local ‑‑user-creds-only\nmsktutil -N -c -b 'CN=COMPUTERS' -s POP-OS\u002Fpop-os -k my-keytab.keytab ‑‑computer-name POP-OS ‑‑upn POP-OS$ ‑‑server adserver.system76.local ‑‑user-creds-only\nkdestroy\n"}]}]}]}]}]},{type:b,value:c}]},{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Move the keytab to the \u002Fetc\u002Fsssd directory, and configure SSSD:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo mv my-keytab.keytab \u002Fetc\u002Fsssd\u002Fmy-keytab.keytab"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo nano \u002Fetc\u002Fsssd\u002Fsssd.conf"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"The SSSD configuration file should contain the following:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"[sssd]\nservices = nss, pam\nconfig_file_version = 2\ndomains = system76.local\n\n[nss]\nentry_negative_timeout = 0\n#debug_level = 5\n\n[pam]\n#debug_level = 5\n\n[domain\u002Fsystem76.local]\n#debug_level = 10\nenumerate = false\nid_provider = ad\nauth_provider = ad\nchpass_provider = ad\naccess_provider = ad\ndyndns_update = false\nad_hostname = pop-os.system76.local\nad_server = adserver.system76.local\nad_domain = system76.local\nldap_schema = ad\nldap_id_mapping = true\nfallback_homedir = \u002Fhome\u002F%u\ndefault_shell = \u002Fbin\u002Fbash\nldap_sasl_mech = gssapi\nldap_sasl_authid = POP-OS$\nkrb5_keytab = \u002Fetc\u002Fsssd\u002Fmy-keytab.keytab\nldap_krb5_init_creds = true\n"}]}]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"After saving, set the appropriate permissions on that configuration file:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo chmod 0600 \u002Fetc\u002Fsssd\u002Fsssd.conf"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c}]},{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Configure PAM:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo nano \u002Fetc\u002Fpam.d\u002Fcommon-session"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Look for the line that contains \"session required pam_unix.so\" and add this line immediately below it:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"session required pam_mkhomedir.so skel=\u002Fetc\u002Fskel umask=0077\n"}]}]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"After saving that file, restart SSSD:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo systemctl restart sssd"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c}]},{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Add the domain administrator to the local sudo group:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"sudo adduser administrator sudo"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Then, test a login with the domain administrator:"}]},{type:b,value:c},{type:a,tag:h,props:{className:[i]},children:[{type:a,tag:j,props:{className:[k],style:l},children:[{type:a,tag:m,props:{},children:[{type:a,tag:d,props:{className:[e]},children:[{type:a,tag:d,props:{style:f},children:[{type:b,value:"su -l administrator"}]}]},{type:b,value:c},{type:a,tag:d,props:{className:[e]},children:[]}]}]}]},{type:b,value:c}]},{type:b,value:c},{type:a,tag:n,props:{},children:[{type:b,value:c},{type:a,tag:g,props:{},children:[{type:b,value:"Reboot the computer. At the login screen, you can click the \"Not listed?\" link, and type the username of any domain user. After logging in with a domain user for the first time, that user will appear on the login screen's user list."}]},{type:b,value:c},{type:a,tag:g,props:{},children:[{type:a,tag:"nuxt-picture",props:{alt:"Login Screen",src:"\u002Fimages\u002Factive-directory-client\u002Flogin-screen-not-listed.png"},children:[]}]},{type:b,value:c}]},{type:b,value:c}]}]},dir:"\u002F",path:"\u002Factive-directory-client",extension:".md",createdAt:o,updatedAt:o,authors:[{username:"btkostner",commitUrl:"https:\u002F\u002Fgithub.com\u002Fsystem76\u002Fdocs\u002Fcommit\u002Fe54bdadaf285cdda4147b9f7bfc8a53111584b5a",avatarUrl:"https:\u002F\u002Favatars.githubusercontent.com\u002Fu\u002F3385679?v=4",profileUrl:"https:\u002F\u002Fgithub.com\u002Fbtkostner"}]},_img:{"/_ipx/images/active-directory-client/login-screen-not-listed.png?w=320&f=png":"\u002F_nuxt\u002Fimage\u002F99bb86.png","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=640&f=png":"\u002F_nuxt\u002Fimage\u002Fad6065.png","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=768&f=png":"\u002F_nuxt\u002Fimage\u002F55a62c.png","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=1024&f=png":"\u002F_nuxt\u002Fimage\u002F0da074.png","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=1280&f=png":"\u002F_nuxt\u002Fimage\u002Fa2ee88.png","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=1536&f=png":"\u002F_nuxt\u002Fimage\u002F08804e.png","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=320&f=webp":"\u002F_nuxt\u002Fimage\u002F7f2bcd.webp","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=640&f=webp":"\u002F_nuxt\u002Fimage\u002Fe7cade.webp","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=768&f=webp":"\u002F_nuxt\u002Fimage\u002Feb8380.webp","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=1024&f=webp":"\u002F_nuxt\u002Fimage\u002F215be9.webp","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=1280&f=webp":"\u002F_nuxt\u002Fimage\u002Fb3a441.webp","/_ipx/images/active-directory-client/login-screen-not-listed.png?w=1536&f=webp":"\u002F_nuxt\u002Fimage\u002F093925.webp"}}],fetch:{},mutations:void 0}}("element","text","\n","span","line","color: var(--code-0F)","p","div","nuxt-content-highlight","pre","shiki","background-color: var(--code-00)","code","li","2021-08-05T20:55:06.722Z")));