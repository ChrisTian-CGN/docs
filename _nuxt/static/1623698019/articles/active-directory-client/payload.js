__NUXT_JSONP__("/articles/active-directory-client", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){return {data:[{article:{slug:"active-directory-client",description:"Learn how to join Pop!_OS to an Active Directory domain",layout:"article",title:"Active Directory Domain",keywords:["Pop!_OS","Security","Linux","Active Directory","Authentication"],image:"http:\u002F\u002Fsupport.system76.com\u002Fimages\u002Fsystem76.png",hidden:false,section:"software",toc:[],body:{type:"root",children:[{type:b,tag:"h1",props:{id:"join-an-active-directory-domain"},children:[{type:b,tag:"a",props:{ariaHidden:"true",href:"#join-an-active-directory-domain",tabIndex:-1},children:[{type:b,tag:d,props:{className:["icon","icon-link"]},children:[]}]},{type:a,value:"Join an Active Directory Domain"}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Pop!_OS and Ubuntu can be joined to an Active Directory domain, which allows users to log in with their existing network credentials."}]},{type:a,value:c},{type:b,tag:"ol",props:{},children:[{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Install the necessary packages:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:"apt"}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:"install"}]},{type:a,value:" sssd heimdal-clients msktutil\n"}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"While installing those packages, you will be prompted for the following information. These are sample responses. Our domain is called \"system76.local\" and our Active Directory server is called \"adserver\" in this example:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:a,value:"Forest name: SYSTEM76\nDomain controller hostname: ADSERVER.system76.local\nAdministrative server "},{type:b,tag:d,props:{className:[e,"keyword"]},children:[{type:a,value:"for"}]},{type:a,value:" your Kerberos realm: ADSERVER.system76.local\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Move the default Kerberos configuration file to a backup, and create a fresh file to use:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:s}]},{type:a,value:" \u002Fetc\u002Fkrb5.conf \u002Fetc\u002Fkrb5.conf.default\n"},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:r}]},{type:a,value:" \u002Fetc\u002Fkrb5.conf\n"}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Edit the \u002Fetc\u002Fkrb5.conf file with the following contents:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,q]},children:[{type:b,tag:l,props:{},children:[{type:a,value:"[libdefaults]\ndefault_realm = SYSTEM76.LOCAL\nrdns = no\ndns_lookup_kdc = true\ndns_lookup_realm = true\n\n[realms]\nSYSTEM76.LOCAL = {\nkdc = ADSERVER.system76.local\nadmin_server = ADSERVER.system76.local\n}\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Initialize Kerberos and generate a keytab file. The first command requires the username of a domain administrator, and our computer's hostname is \"pop-os\" in this example:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,q]},children:[{type:b,tag:l,props:{},children:[{type:a,value:"kinit administrator\nklist\nmsktutil -N -c -b 'CN=COMPUTERS' -s POP-OS\u002Fpop-os.system76.local -k my-keytab.keytab ‑‑computer-name POP-OS ‑‑upn POP-OS$ ‑‑server adserver.system76.local ‑‑user-creds-only\nmsktutil -N -c -b 'CN=COMPUTERS' -s POP-OS\u002Fpop-os -k my-keytab.keytab ‑‑computer-name POP-OS ‑‑upn POP-OS$ ‑‑server adserver.system76.local ‑‑user-creds-only\nkdestroy\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Move the keytab to the \u002Fetc\u002Fsssd directory, and configure SSSD:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:s}]},{type:a,value:" my-keytab.keytab \u002Fetc\u002Fsssd\u002Fmy-keytab.keytab\n"},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:r}]},{type:a,value:" \u002Fetc\u002Fsssd\u002Fsssd.conf\n"}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"The SSSD configuration file should contain the following:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,q]},children:[{type:b,tag:l,props:{},children:[{type:a,value:"[sssd]\nservices = nss, pam\nconfig_file_version = 2\ndomains = system76.local\n\n[nss]\nentry_negative_timeout = 0\n#debug_level = 5\n\n[pam]\n#debug_level = 5\n\n[domain\u002Fsystem76.local]\n#debug_level = 10\nenumerate = false\nid_provider = ad\nauth_provider = ad\nchpass_provider = ad\naccess_provider = ad\ndyndns_update = false\nad_hostname = pop-os.system76.local\nad_server = adserver.system76.local\nad_domain = system76.local\nldap_schema = ad\nldap_id_mapping = true\nfallback_homedir = \u002Fhome\u002F%u\ndefault_shell = \u002Fbin\u002Fbash\nldap_sasl_mech = gssapi\nldap_sasl_authid = POP-OS$\nkrb5_keytab = \u002Fetc\u002Fsssd\u002Fmy-keytab.keytab\nldap_krb5_init_creds = true\n"}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"After saving, set the appropriate permissions on that configuration file:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:"chmod"}]},{type:a,value:" 0600 \u002Fetc\u002Fsssd\u002Fsssd.conf\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Configure PAM:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:o},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:r}]},{type:a,value:" \u002Fetc\u002Fpam.d\u002Fcommon-session\n"}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Look for the line that contains \"session required pam_unix.so\" and add this line immediately below it:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,q]},children:[{type:b,tag:l,props:{},children:[{type:a,value:"session required pam_mkhomedir.so skel=\u002Fetc\u002Fskel umask=0077\n"}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"After saving that file, restart SSSD:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:" systemctl restart sssd\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Add the domain administrator to the local sudo group:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:" adduser administrator "},{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:m}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Then, test a login with the domain administrator:"}]},{type:a,value:c},{type:b,tag:h,props:{className:[i]},children:[{type:b,tag:j,props:{className:[k,n]},children:[{type:b,tag:l,props:{},children:[{type:b,tag:d,props:{className:[e,f]},children:[{type:a,value:"su"}]},{type:a,value:" -l administrator\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:g,props:{},children:[{type:a,value:"Reboot the computer. At the login screen, you can click the \"Not listed?\" link, and type the username of any domain user. After logging in with a domain user for the first time, that user will appear on the login screen's user list."}]},{type:a,value:c},{type:b,tag:g,props:{},children:[{type:b,tag:"img",props:{alt:"Login Screen",src:"\u002Fimages\u002Factive-directory-client\u002Flogin-screen-not-listed.png"},children:[]}]},{type:a,value:c}]},{type:a,value:c}]}]},dir:"\u002F",path:"\u002Factive-directory-client",extension:".md",createdAt:t,updatedAt:t,authors:[{username:"btkostner",commitUrl:"https:\u002F\u002Fgithub.com\u002Fsystem76\u002Fdocs\u002Fcommit\u002Fb546a49f39fb36d3650e6cb565117b195247563e",avatarUrl:"https:\u002F\u002Favatars.githubusercontent.com\u002Fu\u002F3385679?v=4",profileUrl:"https:\u002F\u002Fgithub.com\u002Fbtkostner"}]},_img:{}}],fetch:{},mutations:void 0}}("text","element","\n","span","token","function","p","div","nuxt-content-highlight","pre","line-numbers","code","sudo","language-bash"," ","li","language-text","nano","mv","2021-06-14T19:12:56.393Z")));